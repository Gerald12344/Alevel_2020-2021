{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"/Users/year12/Desktop/Harvey/alevel_2020-2021/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"/Users/year12/Desktop/Harvey/alevel_2020-2021/pages/test.js\",\n    _s = $RefreshSig$();\n\n// Written By Harvey Randall \\\\\nimport { useEffect, useState, useContext } from \"react\";\nimport * as THREE from \"three\";\nimport CameraControls from \"camera-controls\";\nimport { DoubleSide, PerspectiveCamera, Scene, WebGLRenderer } from \"three\";\n\nvar Stats = require(\"stats.js\");\n\nimport { useAppContext } from \"../components/Context/socketioContext\";\nimport { GenerateLabel } from \"../components/gameFundalmentals/nametag\";\nimport { StartSeverClientCommunication, ListenToEvent } from \"../components/Core-API/ConnectAPI\";\nimport { UpdateRenderCycle } from \"../components/Core-API/RenderingHandler\";\nimport { GenerateMainScene } from \"../components/gameFundalmentals/MainSceneHandler\";\nimport { CreateUI } from \"../components/gameUI/gameFeed\";\nCameraControls.install({\n  THREE: THREE\n});\nexport default function render() {\n  _s();\n\n  var _this = this,\n      _ref2;\n\n  var _useState = useState(undefined),\n      child = _useState[0],\n      setChild = _useState[1];\n\n  var _useState2 = useState([]),\n      gameEventData = _useState2[0],\n      setGameEventData = _useState2[1];\n\n  var _useState3 = useState(0),\n      newTheta = _useState3[0],\n      setTheat = _useState3[1];\n\n  var _useState4 = useState(\"not day\"),\n      day = _useState4[0],\n      setDay = _useState4[1];\n\n  var _useState5 = useState(undefined),\n      child2 = _useState5[0],\n      setChild2 = _useState5[1];\n\n  var _useState6 = useState(undefined),\n      pos = _useState6[0],\n      setPos = _useState6[1];\n\n  var _useState7 = useState(undefined),\n      rot = _useState7[0],\n      setRot = _useState7[1];\n\n  var socket = useAppContext();\n\n  var _useState8 = useState(undefined),\n      recievedSeed = _useState8[0],\n      setSeed = _useState8[1];\n\n  var _useState9 = useState(false),\n      rendered = _useState9[0],\n      setRendered = _useState9[1];\n\n  var _useState10 = useState([]),\n      clients = _useState10[0],\n      setClients = _useState10[1];\n\n  var _useState11 = useState(undefined),\n      personData = _useState11[0],\n      setPersonalData = _useState11[1];\n\n  var _useState12 = useState([]),\n      latestPerson = _useState12[0],\n      setLatestestPerson = _useState12[1];\n\n  StartSeverClientCommunication(socket);\n  socket.once(\"welcome\", function (seed, client, data) {\n    setSeed(seed);\n    console.log(client);\n    setClients(client);\n    setPersonalData(data);\n  });\n  useEffect(function () {\n    if (child === undefined || recievedSeed === undefined || rendered === true) return;\n    setRendered(true);\n    var stats = new Stats();\n    stats.showPanel(1);\n    document.body.appendChild(stats.dom);\n    var SceneToGet = new Scene();\n    var Renders = new WebGLRenderer({\n      antialias: true,\n      alpha: true\n    });\n    Renders.setClearColor(0x87ceeb, 1);\n    Renders.setSize(window.innerWidth, window.innerHeight);\n    child.appendChild(Renders.domElement);\n    var CurrentScene = \"Main\";\n    var Camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n    GenerateMainScene(SceneToGet, Renders, document, recievedSeed, child2, Camera);\n    Renders.domElement.requestPointerLock();\n    var players = [];\n\n    function MakeCube() {\n      var color = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"rgb(0,0,0)\";\n      var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"unkown\";\n      var group = new THREE.Group();\n      var geometry = new THREE.BoxGeometry(1, 1, 1);\n      var material = new THREE.MeshLambertMaterial({\n        color: new THREE.Color(color),\n        emissive: new THREE.Color(color)\n      });\n      var cube = new THREE.Mesh(geometry, material);\n      group.add(cube);\n      var cyclinder = new THREE.CylinderGeometry(0.3, 0.3, 0.6, 30);\n      var material2 = new THREE.MeshLambertMaterial({\n        color: 0x000000\n      });\n      var cylinderBuild = new THREE.Mesh(cyclinder, material2);\n      cylinderBuild.rotateX(Math.PI / 2 + Math.PI);\n      cylinderBuild.position.set(0, 0, -0.6);\n      group.add(cylinderBuild);\n      GenerateLabel(name, group);\n      SceneToGet.add(group);\n      group.name = name;\n      return group;\n    }\n\n    var prevData = [];\n\n    var addtoGameFeed = function addtoGameFeed() {\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"Unkown\";\n      var event = arguments.length > 1 ? arguments[1] : undefined;\n\n      var NewGameEventArray = _toConsumableArray(prevData);\n\n      console.log(NewGameEventArray);\n      NewGameEventArray.unshift({\n        name: name,\n        event: event\n      });\n      delete NewGameEventArray[10];\n      delete NewGameEventArray[11];\n      setGameEventData(_toConsumableArray(NewGameEventArray));\n      console.log(\"array below\");\n      console.log(prevData);\n      prevData = NewGameEventArray;\n    };\n\n    clients.forEach(function (e) {\n      console.log(\"Adding PLayer \" + e);\n      var cube = MakeCube(e.color, e.name);\n      players[e] = cube;\n    });\n    socket.on(\"NewPlayer\", function (id, data) {\n      console.log(data);\n      console.log(\"New PLyer \" + id);\n      var cube = MakeCube(data.color, data.name);\n      addtoGameFeed(data === null || data === void 0 ? void 0 : data.name, \"Joined the game!\");\n      players[id] = cube;\n    });\n    socket.on(\"LostPLayer\", function (id, how, data) {\n      console.log(\"lost PLyer \" + id);\n      var cube = players[id];\n      SceneToGet.remove(cube);\n      delete players[id];\n      console.log(data);\n      addtoGameFeed(data === null || data === void 0 ? void 0 : data.name, how === true ? \"Was removed from the game for being inactive\" : \"Left the game!\");\n    });\n    ListenToEvent(\"PlayerLocationUpdate\", function (id, pos, rot, data) {\n      var cube = players[id];\n\n      if (cube) {\n        cube.rotation.set(rot._x, rot._y, rot._z);\n        cube.position.set(pos.x, pos.y, pos.z);\n      } else {\n        var _cube = MakeCube(data === null || data === void 0 ? void 0 : data.color, data === null || data === void 0 ? void 0 : data.name);\n\n        players[id] = _cube;\n      }\n    });\n    socket.on(\"NewChat\", function (data, text) {\n      addtoGameFeed(data.name, text);\n    });\n    setInterval(function () {\n      socket.emit(\"LocationUpdate\", Camera.position, Camera.rotation);\n    }, 10);\n\n    var animate = function animate() {\n      stats.begin();\n      requestAnimationFrame(animate); // Update all moving parts\n\n      UpdateRenderCycle(CurrentScene);\n      Renders.render(SceneToGet, Camera);\n      stats.end();\n    };\n\n    animate();\n  }, [child, clients]);\n\n  var sendChat = function sendChat(e) {\n    e.preventDefault();\n    socket.emit(\"sendChat\", child2.value);\n    child2.value = \"\";\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        position: \"fixed\",\n        marginTop: \"40px\",\n        color: \"white\"\n      },\n      children: personData === undefined ? \"LOADING...\" : personData.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"100vw\",\n        height: \"100vh\",\n        position: \"fixed\",\n        marginTop: \"80px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(CreateUI, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: sendChat,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          ref: function ref(_ref) {\n            return setChild2(_ref);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }, this), _toConsumableArray(gameEventData).map(function (e) {\n        if (e == undefined) return;\n        return /*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            color: \"white\"\n          },\n          children: [e.name, \" - \", e.event]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 25\n        }, _this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }, this), (_ref2 = recievedSeed === undefined) !== null && _ref2 !== void 0 ? _ref2 : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"LOADING SEED!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 44\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: function ref(_ref3) {\n        return setChild(_ref3);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: function ref(_ref4) {\n        return setChild(_ref4);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 9\n  }, this);\n}\n\n_s(render, \"+dY60sEykAkkmuHPt+1h019pv4I=\", false, function () {\n  return [useAppContext];\n});","map":{"version":3,"sources":["/Users/year12/Desktop/Harvey/alevel_2020-2021/pages/test.js"],"names":["useEffect","useState","useContext","THREE","CameraControls","DoubleSide","PerspectiveCamera","Scene","WebGLRenderer","Stats","require","useAppContext","GenerateLabel","StartSeverClientCommunication","ListenToEvent","UpdateRenderCycle","GenerateMainScene","CreateUI","install","render","undefined","child","setChild","gameEventData","setGameEventData","newTheta","setTheat","day","setDay","child2","setChild2","pos","setPos","rot","setRot","socket","recievedSeed","setSeed","rendered","setRendered","clients","setClients","personData","setPersonalData","latestPerson","setLatestestPerson","once","seed","client","data","console","log","stats","showPanel","document","body","appendChild","dom","SceneToGet","Renders","antialias","alpha","setClearColor","setSize","window","innerWidth","innerHeight","domElement","CurrentScene","Camera","requestPointerLock","players","MakeCube","color","name","group","Group","geometry","BoxGeometry","material","MeshLambertMaterial","Color","emissive","cube","Mesh","add","cyclinder","CylinderGeometry","material2","cylinderBuild","rotateX","Math","PI","position","set","prevData","addtoGameFeed","event","NewGameEventArray","unshift","forEach","e","on","id","how","remove","rotation","_x","_y","_z","x","y","z","text","setInterval","emit","animate","begin","requestAnimationFrame","end","sendChat","preventDefault","value","marginTop","width","height","ref","map"],"mappings":"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","sourcesContent":["// Written By Harvey Randall \\\\\n\nimport { useEffect, useState, useContext } from \"react\";\nimport * as THREE from \"three\";\nimport CameraControls from \"camera-controls\";\nimport { DoubleSide, PerspectiveCamera, Scene, WebGLRenderer } from \"three\";\nvar Stats = require(\"stats.js\");\nimport { useAppContext } from \"../components/Context/socketioContext\";\nimport { GenerateLabel } from \"../components/gameFundalmentals/nametag\";\nimport {\n    StartSeverClientCommunication,\n    ListenToEvent,\n} from \"../components/Core-API/ConnectAPI\";\nimport { UpdateRenderCycle } from \"../components/Core-API/RenderingHandler\";\nimport { GenerateMainScene } from \"../components/gameFundalmentals/MainSceneHandler\";\nimport { CreateUI } from \"../components/gameUI/gameFeed\";\nCameraControls.install({ THREE: THREE });\n\nexport default function render() {\n    const [child, setChild] = useState(undefined);\n    const [gameEventData, setGameEventData] = useState([]);\n\n    const [newTheta, setTheat] = useState(0);\n    const [day, setDay] = useState(\"not day\");\n    const [child2, setChild2] = useState(undefined);\n    const [pos, setPos] = useState(undefined);\n    const [rot, setRot] = useState(undefined);\n    const socket = useAppContext();\n    const [recievedSeed, setSeed] = useState(undefined);\n    const [rendered, setRendered] = useState(false);\n    const [clients, setClients] = useState([]);\n    const [personData, setPersonalData] = useState(undefined);\n    const [latestPerson, setLatestestPerson] = useState([]);\n\n    StartSeverClientCommunication(socket);\n\n    socket.once(\"welcome\", (seed, client, data) => {\n        setSeed(seed);\n        console.log(client);\n        setClients(client);\n        setPersonalData(data);\n    });\n\n    useEffect(() => {\n        if (\n            child === undefined ||\n            recievedSeed === undefined ||\n            rendered === true\n        )\n            return;\n        setRendered(true);\n\n        let stats = new Stats();\n        stats.showPanel(1);\n        document.body.appendChild(stats.dom);\n\n        let SceneToGet = new Scene();\n        let Renders = new WebGLRenderer({\n            antialias: true,\n            alpha: true,\n        });\n\n        Renders.setClearColor(0x87ceeb, 1);\n\n        Renders.setSize(window.innerWidth, window.innerHeight);\n        child.appendChild(Renders.domElement);\n\n        let CurrentScene = \"Main\";\n\n        var Camera = new PerspectiveCamera(\n            75,\n            window.innerWidth / window.innerHeight,\n            0.1,\n            1000\n        );\n        GenerateMainScene(\n            SceneToGet,\n            Renders,\n            document,\n            recievedSeed,\n            child2,\n            Camera\n        );\n\n        Renders.domElement.requestPointerLock();\n\n        let players = [];\n\n        function MakeCube(color = \"rgb(0,0,0)\", name = \"unkown\") {\n            const group = new THREE.Group();\n            const geometry = new THREE.BoxGeometry(1, 1, 1);\n            const material = new THREE.MeshLambertMaterial({\n                color: new THREE.Color(color),\n                emissive: new THREE.Color(color),\n            });\n            const cube = new THREE.Mesh(geometry, material);\n            group.add(cube);\n            const cyclinder = new THREE.CylinderGeometry(0.3, 0.3, 0.6, 30);\n            const material2 = new THREE.MeshLambertMaterial({\n                color: 0x000000,\n            });\n            const cylinderBuild = new THREE.Mesh(cyclinder, material2);\n            cylinderBuild.rotateX(Math.PI / 2 + Math.PI);\n            cylinderBuild.position.set(0, 0, -0.6);\n            group.add(cylinderBuild);\n\n            GenerateLabel(name, group);\n            SceneToGet.add(group);\n            group.name = name;\n            return group;\n        }\n\n        let prevData = [];\n\n        let addtoGameFeed = (name = \"Unkown\", event) => {\n            let NewGameEventArray = [...prevData];\n            console.log(NewGameEventArray);\n            NewGameEventArray.unshift({ name: name, event: event });\n            delete NewGameEventArray[10];\n            delete NewGameEventArray[11];\n            setGameEventData([...NewGameEventArray]);\n            console.log(\"array below\");\n            console.log(prevData);\n            prevData = NewGameEventArray;\n        };\n\n        clients.forEach((e) => {\n            console.log(\"Adding PLayer \" + e);\n            let cube = MakeCube(e.color, e.name);\n            players[e] = cube;\n        });\n\n        socket.on(\"NewPlayer\", (id, data) => {\n            console.log(data);\n            console.log(\"New PLyer \" + id);\n            let cube = MakeCube(data.color, data.name);\n            addtoGameFeed(data?.name, \"Joined the game!\");\n\n            players[id] = cube;\n        });\n\n        socket.on(\"LostPLayer\", (id, how, data) => {\n            console.log(\"lost PLyer \" + id);\n            let cube = players[id];\n            SceneToGet.remove(cube);\n            delete players[id];\n            console.log(data);\n            addtoGameFeed(\n                data?.name,\n                how === true\n                    ? \"Was removed from the game for being inactive\"\n                    : \"Left the game!\"\n            );\n        });\n\n        ListenToEvent(\"PlayerLocationUpdate\", (id, pos, rot, data) => {\n            let cube = players[id];\n            if (cube) {\n                cube.rotation.set(rot._x, rot._y, rot._z);\n                cube.position.set(pos.x, pos.y, pos.z);\n            } else {\n                let cube = MakeCube(data?.color, data?.name);\n\n                players[id] = cube;\n            }\n        });\n        socket.on(\"NewChat\", (data, text) => {\n            addtoGameFeed(data.name, text);\n        });\n        setInterval(() => {\n            socket.emit(\"LocationUpdate\", Camera.position, Camera.rotation);\n        }, 10);\n\n        var animate = function () {\n            stats.begin();\n            requestAnimationFrame(animate);\n\n            // Update all moving parts\n            UpdateRenderCycle(CurrentScene);\n\n            Renders.render(SceneToGet, Camera);\n            stats.end();\n        };\n\n        animate();\n    }, [child, clients]);\n\n    let sendChat = (e) => {\n        e.preventDefault();\n        socket.emit(\"sendChat\", child2.value);\n        child2.value = \"\";\n    };\n\n    return (\n        <main>\n            <h1\n                style={{\n                    position: \"fixed\",\n                    marginTop: \"40px\",\n                    color: \"white\",\n                }}>\n                {personData === undefined ? \"LOADING...\" : personData.name}\n            </h1>\n            <div\n                style={{\n                    width: \"100vw\",\n                    height: \"100vh\",\n                    position: \"fixed\",\n                    marginTop: \"80px\",\n                }}>\n                <CreateUI />\n                <form onSubmit={sendChat}>\n                    <input ref={(ref) => setChild2(ref)}></input>\n                    <input type=\"Submit\"></input>\n                </form>\n                {[...gameEventData].map((e) => {\n                    if (e == undefined) return;\n                    return (\n                        <h4 style={{ color: \"white\" }}>\n                            {e.name} - {e.event}\n                        </h4>\n                    );\n                })}\n            </div>\n            {recievedSeed === undefined ?? <h1>LOADING SEED!</h1>}\n            <div ref={(ref) => setChild(ref)}></div>\n            <div ref={(ref) => setChild(ref)}></div>\n        </main>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}