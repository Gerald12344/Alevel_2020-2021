{"ast":null,"code":"// Written By Harvey Randall \\\\\nimport { BufferAttribute, Mesh, MeshPhongMaterial, PlaneBufferGeometry, Vector2, Vector3 } from \"three\";\nimport { Perlin, FBM } from \"../Core-API/PerlinNoise/PerlingNoise\";\n\nvar SimplexNoise = require(\"simplex-noise\");\n\nvar currentTerrain;\nexport function ReturnTerrainPointer() {\n  return currentTerrain;\n}\n/*eslint complexity: [\"error\", 20]*/\n\nexport function generateTerrain(seed, SceneToGet) {\n  //------------[MAIN FUNCTION VARIABLES]------------\\\\\n  var simplex = new SimplexNoise(seed);\n  var geometry = new PlaneBufferGeometry(500, 500, 100, 100);\n  var colours = [];\n  var positionAttribute = geometry.getAttribute(\"position\"); //------------[Edit the Geomtry Accordingly]------------\\\\\n\n  for (var i = 0, l = geometry.attributes.position.count; i < l; i++) {\n    // Get Data position\n    var vertex = new Vector3();\n    vertex.fromBufferAttribute(positionAttribute, i); // Check Height from Perlin Noise Generator\n\n    var height = simplex.noise2D(vertex.x / 128, vertex.y / 128) * 30; // Set the height accordingly\n\n    geometry.attributes.position.array[i * 3 + 2] = height; // Update Vertice colours accordinly\n\n    if (height > 23) {\n      colours.push(1, 1, 1);\n    } else if (height > 5) {\n      colours.push(0.56, 0.54, 0.48);\n    } else if (height < 2) {\n      colours.push(0.501, 0.772, 0.87);\n    } else {\n      colours.push(0.56, 0.68, 0.166);\n    }\n  } //------------[Create Material]------------\\\\\n\n\n  var material = new MeshPhongMaterial({\n    vertexColors: colours,\n    reflectivity: 0,\n    roughness: 1,\n    flatShading: true\n  }); //------------[Create Mesh]------------\\\\\n\n  var plane2 = new Mesh(geometry, material);\n  plane2.receiveShadow = true;\n  plane2.castShadow = true;\n  plane2.position.y = -3;\n  plane2.rotateX(Math.PI / 2 + Math.PI); //------------[Edit colour attribute]------------\\\\\n\n  geometry.setAttribute(\"color\", new BufferAttribute(new Float32Array(colours), 3)); //geometry.computeVertexNormals();\n  //------------[Add to Base Scene]------------\\\\\n\n  currentTerrain = plane2;\n  plane2.name = \"MAIN_TERRAIN\";\n  SceneToGet.add(plane2);\n}\nexport function generateTerrainChunk(seed, Position, gain) {\n  //------------[MAIN FUNCTION VARIABLES]------------\\\\\n  var simplex = new SimplexNoise(seed);\n  var geometry = new PlaneBufferGeometry(500, 500, 100, 100);\n  var colours = [];\n  var fbm = new FBM({\n    seed: seed,\n    scale: 0.007,\n    octaves: 6,\n    persistance: 0.5,\n    lacunarity: 2,\n    redistribution: 2,\n    height: 40\n  });\n  console.log(Position);\n  var positionAttribute = geometry.getAttribute(\"position\"); //------------[Edit the Geomtry Accordingly]------------\\\\\n\n  for (var i = 0, l = geometry.attributes.position.count; i < l; i++) {\n    // Get Data position\n    var vertex = new Vector3();\n    vertex.fromBufferAttribute(positionAttribute, i); // Check Height from Perlin Noise Generator\n\n    var height = fbm.get2(new Vector2(vertex.x + Position.x, vertex.y - Position.y)) * gain * 4; // Set the height accordingly\n\n    geometry.attributes.position.array[i * 3 + 2] = height; // Update Vertice colours accordinly\n\n    if (height > 43) {\n      colours.push(1, 1, 1);\n    } else if (height > 5) {\n      colours.push(0.56, 0.54, 0.48);\n    } else if (height < 2) {\n      colours.push(0.8949, 0.9686, 0.651);\n    } else {\n      colours.push(0.56, 0.68, 0.166);\n    }\n  } //------------[Create Material]------------\\\\\n\n\n  var material = new MeshPhongMaterial({\n    vertexColors: colours,\n    reflectivity: 0,\n    roughness: 1,\n    flatShading: true,\n    blending: false\n  }); //------------[Create Mesh]------------\\\\\n\n  var plane2 = new Mesh(geometry, material);\n  plane2.receiveShadow = true;\n  plane2.castShadow = true;\n  plane2.position.set(Position.x, -3, Position.y);\n  plane2.rotateX(Math.PI / 2 + Math.PI); //------------[Edit colour attribute]------------\\\\\n\n  geometry.setAttribute(\"color\", new BufferAttribute(new Float32Array(colours), 3)); //------------[Add to Base Scene]------------\\\\\n\n  currentTerrain = plane2;\n  plane2.name = \"Terrain_Chunk_\".concat(Position.x, \":\").concat(Position.y);\n  return plane2;\n}","map":null,"metadata":{},"sourceType":"module"}